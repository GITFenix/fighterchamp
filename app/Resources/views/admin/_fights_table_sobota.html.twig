{% import '_macros/macro.html.twig' as macro %}
<div class="col-xs-12">
    <div>
        Zawodnicy którzy skasowali swoje zgłoszenia a mają walkę = {{ signUps|length }} <br>
        {% for signUp in signUps  %}
            {{ signUp.user.name }} {{ signUp.user.surname }} ,
        {% endfor %}
    </div>
    <br>
    <br>
    <div>
        <span class="label label-success">W</span> - Win (Wygrana)
        <span class="label label-warning">D</span> - Draw (Remis)
        <span class="label label-danger">L</span> - Loss (Przegrana)
    </div>
    <table class="table">
        <thead>
        <tr>
            <th></th>
            <th>Opublikowane?</th>
            {#<th>Dzień</th>#}
            <th>Kolejność</th>
            <th>
                Zawodnik 1 <br>
                <span class="label label-danger">Narożnik Czerwony</span>
            </th>
            <th></th>
            <th>
                Zawodnik 2 <br>
                <span class="label label-primary">Narożnik Niebieski</span>
            </th>
            <th>Wygrany</th>
            <th>Klasa</th>
            <th>Kat. wagowa</th>
        </tr>
        </thead>
        <tbody>
        {% for fight in fights %}
            <tr>
                <td>
                    <button class="btn btn-danger js-fight-delete" value="{{ fight.id }}">
                        <i class="fa fa-trash-o fa-lg"></i> Rozparuj
                    </button>
                </td>
                <td>
                    <input class="checkbox_ready" type="checkbox" {{ fight.isVisible? 'checked' : '' }} value="{{ fight.id }}">
                </td>
                {#<td><select class="select_day">#}
                        {#<option value="{{ fight.id }}|Sobota" {{ fight.day == 'Sobota'? 'selected' }}>Sobota</option>#}
                        {#<option value="{{ fight.id }}|Niedziela"{{ fight.day == 'Niedziela'? 'selected' }} >Niedziela</option>#}
                    {#</select></td>#}
                <td><select class="select_order" id="{{ loop.index }}" autocomplete="off">
                        {% for i in 1..fights|length %}
                            <option value="{{ i }}|Sobota" {{ fight.position == loop.index ? 'selected' }} >{{ i }}</option>
                        {% endfor %}
                    </select>
                </td>

                {% for userFight in fight.usersFight %}
                    {% set signUp = userFight.user.getSignUpTournament(tournament)  %}

                    {% set user = userFight.user %}

                    {% if loop.index == 2 %}
                        <td>
                            <a href="{{ path("toggle_corners", { 'id' : fight.id }) }}">
                                <i class="fa fa-exchange fa-2x" aria-hidden="true"></i>
                            </a>
                        </td>
                    {% endif %}

                    <td>
                        <a href="{{ path('user_show', {'id': user.id }) }}"> {{ user.name }} {{ user.surname }}

                            {{ macro.fightResultForUserFight(userFight) }}

                    {% if user.club %} <br> ({{ user.club }}) {% endif %}
                            </a>
                        <br>
                        {{ signUp? signUp.formula }}
                        {{ signUp? signUp.getFinallWeight }}
                        <br>
                        {% if user.birthDay %}
                            {% set age = user.birthDay |getAge %}
                            {{ age }} lat {{ age <= 18 ? '(Junior)' }}
                        {% endif %}
                        <br>
                        {% if signUp %}
                        {{ signUp.isPaid ? '' : 'Niezapłacone'  }}
                            {{ signUp.weighted ? '' : 'Niezważony' }}
                        {% endif %}
                    </td>

                {% endfor %}

                <td>
                    <select class="select_winner" autocomplete="off"> <option value="{{ fight.usersFight[0].id }}|reset"></option>
                        {% for userFight in fight.usersFight %}

                            <option {{ userFight.result == 'win' ? 'selected' }} value="{{ userFight.id }}|win">
                                {{ userFight.user.surname }} {{ userFight.user.name }}
                            </option>

                        {% endfor %}

                        <option {{ fight.usersFight[0].result == 'draw' ? 'selected' : '' }} value="{{ fight.usersFight[0].id }}|draw" >Remis</option>

                    </select>
                </td>

                <td>{{ fight.formula }}</td>
                <td>{{ fight.weight }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {#<a href="{{ path('allFightsReady', {'id': tournament.id }) }}" class="btn btn-primary"> Opublikuj Wszystkie Walki</a>#}
</div>